# Adventure Engine v2 - Text Adventure Game Engine in C

## Project Description

Adventure Engine v2 is a production-ready, open-source text adventure game engine written in C11. It features a complete single-player experience with parser, world system, save/load functionality, and a smart terminal UI. The engine also includes multiplayer infrastructure for team building and collaborative gameplay (2-8 players with role-based mechanics).

**Key Characteristics:**
- Language: C11
- License: MIT
- Status: Production-ready single-player, multiplayer infrastructure built
- Test Coverage: 88% (23/26 tests passing)
- Build: Zero compiler warnings, ~1 second build time
- Platform: Linux, macOS (terminal-based, SSH-friendly)

## Capabilities

### Core Features
1. **Command Parser**: Natural language verb+noun parsing with multi-word noun support
2. **World System**: 50 rooms, 50 items capacity, 20-item inventory
3. **World Loader**: Parse human-readable .world files with validation
4. **Save/Load**: Multiple save slots with state persistence to ~/.adventure-saves/
5. **Terminal UI**: ncurses + readline integration with scrolling, context coloring, command history
6. **Example Content**: 4 complete playable worlds (Dark Tower, Haunted Mansion, Crystal Caverns, Sky Pirates)

### Multiplayer (v3.0 Infrastructure)
1. **Session Management**: 2-8 player sessions with lifecycle states (LOBBY → ACTIVE → COMPLETED)
2. **Role System**: 6 roles (LEADER, SCOUT, ENGINEER, MEDIC, DIPLOMAT, SPECIALIST)
3. **IPC Messaging**: 9 message types with priority queuing
4. **Tmux Integration**: 4-panel dashboard (narrative, map, stats, log)
5. **Team Analytics**: Track communication and collaboration

### Testing & Quality
- 26 unit tests across parser, world system, and save/load
- GitHub Actions CI/CD (Ubuntu, macOS)
- Valgrind memory leak detection
- Comprehensive documentation (2,000+ lines)

## Quick Start

```bash
# Install dependencies (Ubuntu)
sudo apt-get install build-essential libncurses-dev libreadline-dev

# Clone and build
git clone https://github.com/jcaldwell-labs/adventure-engine-v2.git
cd adventure-engine-v2
make all

# Run tests
make run-tests

# Play
./build/adventure-engine
```

## Common Patterns

### Adding a New Command

1. Update parser if needed (src/parser.c)
2. Add command function in src/main.c:
```c
void cmd_new_command(World *world, const char *arg) {
    // Implementation
}
```
3. Add to command dispatch in handle_command()
4. Update help text
5. Add test case

### Creating a World File

```ini
[WORLD]
name: My Adventure
start: entrance

[ROOM:entrance]
name: Entrance Hall
description: A grand entrance with marble floors.
exits: north=hall

[ITEM:key]
name: golden key
description: A shiny golden key.
takeable: yes
location: entrance
```

### Running Tests

```bash
make tests        # Build tests
make run-tests    # Run all tests
./build/test_parser      # Run specific test
./build/test_world
./build/test_save_load
```

## Use Cases

1. **Corporate Team Building**: Collaborative multiplayer adventures for remote teams
2. **Educational Workshops**: Teaching programming, game design, storytelling
3. **Game Development Learning**: Study clean C architecture, parsers, state machines
4. **Interactive Fiction**: Create branching narratives with save/load support
5. **Terminal Gaming**: Retro-style gaming over SSH, minimal systems

## Architecture Overview

### Component Hierarchy
```
Terminal UI (smartterm_simple.c)
    ↓
Game Engine Core
    ├── Parser (parser.c) - Command parsing
    ├── World (world.c) - Rooms, items, inventory
    └── Save/Load (save_load.c) - State persistence
    ↓
World Loader (world_loader.c) - Parse .world files
```

### Key Data Structures

**Command** (parser.h):
- verb[64]: Action (go, take, examine)
- noun[64]: Target (north, key, torch)
- valid: Parse success flag

**World** (world.h):
- rooms[50]: Room array
- items[50]: Item array
- inventory[20]: Player inventory
- current_room: Current position

**Room**:
- id, name, description
- exits[6]: Connections (N, S, E, W, U, D)
- items[50]: Items in room
- visited: Discovery tracking

**Item**:
- id, name, description
- takeable: Can be picked up
- visible: Is discovered

### Memory Management
- Fixed-size arrays (predictable memory usage)
- No dynamic allocation during gameplay
- Stack-based Command structures
- Safe for embedded/constrained systems

### Build System
- Makefile with targets: all, lib, engine, multiplayer, tests, run, run-tests, clean
- Dependencies: ncurses, readline
- Zero warnings with -Wall -Wextra -std=c11
- Incremental builds supported

## File Organization

### Source Code (src/)
- main.c (499 LOC): Game loop, command dispatch
- parser.c (99 LOC): Command parsing
- world.c (260 LOC): World/room/item system
- world_loader.c (376 LOC): .world file parser
- save_load.c (296 LOC): Game persistence
- session.c (514 LOC): Multiplayer session management
- player.c (550 LOC): Player roles & states
- ipc.c (602 LOC): Inter-process communication
- session_coordinator.c (298 LOC): Multiplayer daemon

### Headers (include/)
- Corresponding .h files for all modules
- Clean API definitions
- Well-documented functions

### Tests (tests/)
- test_parser.c: 8 tests (command parsing)
- test_world.c: 11 tests (world operations)
- test_save_load.c: 7 tests (persistence)

### Documentation (docs/)
- ARCHITECTURE.md: System architecture
- WORLD-FORMAT.md: .world file specification
- TROUBLESHOOTING.md: Common issues
- MULTIPLAYER-SETUP.md: Multiplayer guide
- QUICK-START-MULTIPLAYER.md: 60-second guide

### Example Content (worlds/)
- dark_tower.world (3 rooms, beginner)
- haunted_mansion.world (7 rooms, intermediate)
- crystal_caverns.world (12 rooms, advanced)
- sky_pirates.world (7 rooms, intermediate)

## AI Development Guide

See **CLAUDE.md** for comprehensive AI assistant guide including:
- Project overview and context
- Codebase structure
- Component descriptions
- Build system documentation
- Testing guidelines
- Common tasks
- Known limitations
- Quick reference

## Contributing

See **CONTRIBUTING.md** for:
- Development setup
- Code style guidelines
- Testing requirements
- Pull request process
- Community guidelines

## Known Limitations

1. Multiplayer infrastructure built but not integrated with game engine (in progress)
2. Tab characters in commands not split by parser (use spaces)
3. No NPC dialogue system (static world files)
4. No puzzle mechanics (locks, keys, triggers not implemented yet)

## Roadmap

**Completed (v1.0-v2.0):**
- Single-player engine
- World loading system
- Save/load functionality
- Test suite and CI/CD
- Comprehensive documentation

**In Progress (v3.0):**
- Multiplayer infrastructure
- Tmux dashboard
- Team analytics

**Planned (v3.1+):**
- Multiplayer game integration
- NPC dialogue system
- Puzzle mechanics
- Quest tracking
- Achievement system

## Repository URLs

- Main: https://github.com/jcaldwell-labs/adventure-engine-v2
- Issues: https://github.com/jcaldwell-labs/adventure-engine-v2/issues
- Discussions: https://github.com/jcaldwell-labs/adventure-engine-v2/discussions
- CI/CD: https://github.com/jcaldwell-labs/adventure-engine-v2/actions

## Contact & Support

- Documentation: Check docs/ directory
- Issues: GitHub Issues for bug reports and feature requests
- Contributions: PRs welcome (see CONTRIBUTING.md)
- License: MIT (free to use, modify, distribute)

---

**For AI tools**: This project is well-documented with clean C11 code, comprehensive tests, and detailed guides. The CLAUDE.md file provides AI-specific development context. Code compiles with zero warnings and has 88% test coverage. Perfect for learning C game development, text adventure engines, or team-building applications.
